<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neural: Exemple</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Neural
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_exemple.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Exemple </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md5"></a>
XOR</h1>
<p>This example consists in using a multilayer perceptron to solve the XOR problem. To understand this example, let's look at this diagram for a moment.</p>
<div class="image">
<img src="XORproblem.jpeg" alt="" width="700px"/>
</div>
<p>First of all, it is necessary to create the data we need to train the neural network. </p><div class="fragment"><div class="line">MatrixXd x_data(4,2);</div>
<div class="line">x_data &lt;&lt; </div>
<div class="line">            0,0,</div>
<div class="line">            0,1,</div>
<div class="line">            1,0,</div>
<div class="line">            1,1;</div>
<div class="line"> </div>
<div class="line">MatrixXd x_valid(4,1);</div>
<div class="line">x_train &lt;&lt;  0,</div>
<div class="line">            1,</div>
<div class="line">            1,</div>
<div class="line">            0;</div>
</div><!-- fragment --><p>As we can see, the matrices correspond to the inputs and outputs of the problem to solve.</p>
<p>We need also to create the test MAtrix for validation result. </p><div class="fragment"><div class="line">MatrixXd x_test(4,2);</div>
<div class="line">x_test &lt;&lt; </div>
<div class="line">            1,1, // -&gt; 0 </div>
<div class="line">            0,1, // -&gt; 1</div>
<div class="line">            0,0, // -&gt; 0</div>
<div class="line">            1,0; // -&gt; 1</div>
</div><!-- fragment --><p>The data configuration is finished, we can now create our neural network!</p>
<div class="fragment"><div class="line">Network net;</div>
</div><!-- fragment --><p>Now that our network is declared, we can also create the different activation functions, and the loss function that we will use to solve this problem.</p>
<div class="fragment"><div class="line">Loss* mse = new Mse(); </div>
<div class="line">Activation* than = new Than();</div>
</div><!-- fragment --><p>In order to build the structure of our network, we must create the different layers of it:</p>
<div class="fragment"><div class="line">Fc_Layer* fcl1 = new Fc_Layer(2,5);</div>
<div class="line">Activation_layer* acl1 = new Activation_layer(than);</div>
<div class="line">Fc_Layer* fcl2 = new Fc_Layer(5,1);</div>
<div class="line">Activation_layer* acl2 = new Activation_layer(than);</div>
</div><!-- fragment --><p>The first layer has two inputs (0 and 1 which represents a sample of the previously created data set), and 5 outputs. The last layer has 5 inputs that correspond to the output of layer 1, and 1 output that represents the value we want to predict.</p>
<p>Now let's add the layers to the networks</p>
<div class="fragment"><div class="line">net.Add(fcl1);</div>
<div class="line">net.Add(acl1);</div>
<div class="line">net.Add(fcl2);</div>
<div class="line">net.Add(acl2);</div>
</div><!-- fragment --><p>All we have to do is to train the network, specifying which loss function we want to use and check its operation.</p>
<div class="fragment"><div class="line">net.Use(mse);</div>
<div class="line">net.Fit(x_data,x_train,100,0.1,1);</div>
</div><!-- fragment --><p>Here, we pass to the "fit" function the input data set, the result set, the number of epochs, the learning rate, and the batch size. The dataset being minimal, we set the batch size to 1.</p>
<p>We want to test our network on the test data set created earlier. So we can write :</p>
<div class="fragment"><div class="line">net.Predict(x_test);</div>
</div><!-- fragment --><p>Now you can compile and observe your results!</p>
<h1><a class="anchor" id="autotoc_md6"></a>
MNIST Dense</h1>
<p>We will now turn to a slightly more complicated problem: Solving the MNIST. The mnist database, is a set of data representing black and white numbers written by hand. It is a very well known dataset in the machine learning world because there has been a lot of research on it. Indeed, banks use this kind of algorithms to find automatically which numbers you have entered on your bank draft! It's better that the algorithm knows the difference between a 1 and a 9 you understand why ;) We will use the same neural structure in full connected as for the XOR example. By changing of course our input and the number of hidden layer.</p>
<p>First, you need to import the MNIST data. Fortunately, <a class="el" href="namespaceNeural.html">Neural</a> has a function that allows you to quickly import and manipulate the MNIST dataset.</p>
<div class="fragment"><div class="line">mnist train(&quot;../dataset/MNIST/train-images-idx3-ubyte&quot;,</div>
<div class="line">             &quot;../dataset/MNIST/train-labels-idx1-ubyte&quot;, 54000);</div>
<div class="line"> </div>
<div class="line">mnist test(&quot;../dataset/MNIST/t10k-images-idx3-ubyte&quot;,</div>
<div class="line">             &quot;../dataset/MNIST/t10k-labels-idx1-ubyte&quot;, 30);</div>
</div><!-- fragment --><p>We import 54000 samples for the training, and we want to check the network on 30 samples. We must now create our neural network. This problem consumes more resources than the XOR problem, so we can use multiple threads like this: </p><div class="fragment"><div class="line">Network net;</div>
<div class="line">net.SetThreads(3);</div>
</div><!-- fragment --><div class="fragment"><div class="line">Activation* than = new Than();</div>
<div class="line">Loss* mse = new Mse();</div>
<div class="line">net.Use(mse);</div>
</div><!-- fragment --><p>A MNIST image is 28 px*28px (in black and white), so we have to assign 28*28 neurons for the first layer. The last layer represents the list of values that the network will predict. We want to predict a number between 0 and 9, so we have 10 neurons that correspond to the probability of the match with the input set. </p><div class="fragment"><div class="line">Fc_Layer* fcl1 = new Fc_Layer(784,128);</div>
<div class="line">Activation_layer* acl1 = new Activation_layer(than);</div>
<div class="line">Fc_Layer* fcl2 = new Fc_Layer(128,10);</div>
<div class="line">Activation_layer* acl2 = new Activation_layer(than);</div>
<div class="line">net.Add(fcl1);</div>
<div class="line">net.Add(acl1);</div>
<div class="line">net.Add(fcl2);</div>
<div class="line">net.Add(acl2);</div>
</div><!-- fragment --><p>We can now train our network:</p>
<div class="fragment"><div class="line">net.Fit(train.data.images,train.data.labels,4,0.1,1);</div>
<div class="line">net.Predict(test.data.images);</div>
<div class="line">cout &lt;&lt; &quot;result true \n&quot; &lt;&lt; test.data.labels &lt;&lt; endl;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
MNIST Conv</h1>
<p><a class="el" href="namespaceNeural.html">Neural</a> is a library developed in C++ allowing the realization of artificial neural networks. It is intended to be simple to use and easy to install (Just create the Docker and start to code!). If you encounter any problem, don't hesitate to let me know.</p>
<p>It is built on the basis of eigen which allows to facilitate the manipulation of data structures, and to have various functions of manipulation of matrices or lists. Moreover, eigen has natively a multi-threading function which allows you to easily add the number of threads you want to allocate to optimize the performances you need. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
